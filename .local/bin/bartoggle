#!/bin/bash

# Define the counter file
COUNTER_FILE=/tmp/.eww_script_counter

# Check if the counter file doesn't exist or is empty, then initialize the counter to 1
if [ ! -f "$COUNTER_FILE" ] || [ ! -s "$COUNTER_FILE" ]; then
    echo 1 > $COUNTER_FILE
fi

# Read the current counter value
COUNTER=$(cat $COUNTER_FILE)

# Based on the counter value, decide which command to run
if [ $COUNTER -eq 1 ]; then
    hyprctl reload
    hyprctl plugin load /home/nehrbash/src/sn-hyprland-plugins/hyprbars/hyprbars.so
    eww open-many bar bar2 leftbar leftbar2 corner-ul corner-ur corner-bl corner-br corner2-ul corner2-ur corner2-bl corner2-br
elif [ $COUNTER -eq 2 ]; then
    hyprctl --batch "keyword animations:enabled 0;\
            keyword decoration:drop_shadow 0;\
            keyword decoration:blur 0;\
            keyword general:gaps_in 0;\
            keyword general:gaps_out 0;\
            keyword general:border_size 1;\
            keyword decoration:rounding 0;\
            keyword decoration:active_opacity 1;\
            keyword decoration:inactive_opacity 1;\
            "
    hyprctl plugin unload /home/nehrbash/src/sn-hyprland-plugins/hyprbars/hyprbars.so
    eww close corner-ul corner-ur corner-bl corner-br corner2-ul corner2-ur corner2-bl corner2-br
elif [ $COUNTER -eq 3 ]; then
    eww close-all
fi

# Increment the counter, and if it's 4, reset it back to 1
if [ $COUNTER -eq 3 ]; then
    COUNTER=1
else
    COUNTER=$((COUNTER + 1))
fi

# Write the updated counter value back to the file
echo $COUNTER > $COUNTER_FILE

